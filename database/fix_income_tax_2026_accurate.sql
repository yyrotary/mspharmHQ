-- ===================================
-- 2026년 근로소득 간이세액표 (국세청 2024년 공식 자료)
-- 정확한 데이터 반영
-- ===================================

-- 기존 데이터 삭제
TRUNCATE TABLE income_tax_brackets_2026;

-- 부양가족 1인 (본인만) - 정확한 데이터
INSERT INTO income_tax_brackets_2026 (dependent_count, income_from, income_to, tax_amount) VALUES
  -- 0 ~ 1,060,000원: 비과세
  (1, 0, 1060000, 0),
  
  -- 1,060,000 ~ 9,980,000원: 5천원 단위
  (1, 1060000, 1065000, 1040),
  (1, 1065000, 1070000, 1110),
  (1, 1070000, 1075000, 1180),
  (1, 1075000, 1080000, 1250),
  (1, 1080000, 1085000, 1320),
  (1, 1085000, 1090000, 1390),
  (1, 1090000, 1095000, 1460),
  (1, 1095000, 1100000, 1530),
  (1, 1100000, 1105000, 1600),
  (1, 1105000, 1110000, 1670),
  (1, 1110000, 1115000, 1740),
  (1, 1115000, 1120000, 1810),
  (1, 1120000, 1125000, 1880),
  (1, 1125000, 1130000, 1950),
  (1, 1130000, 1135000, 2020),
  (1, 1135000, 1140000, 2090),
  (1, 1140000, 1145000, 2160),
  (1, 1145000, 1150000, 2230),
  (1, 1150000, 1155000, 2300),
  (1, 1155000, 1160000, 2370),
  (1, 1160000, 1165000, 2440),
  (1, 1165000, 1170000, 2500),
  (1, 1170000, 1175000, 2570),
  (1, 1175000, 1180000, 2640),
  (1, 1180000, 1185000, 2710),
  (1, 1185000, 1190000, 2780),
  (1, 1190000, 1195000, 2850),
  (1, 1195000, 1200000, 2920),
  (1, 1200000, 1205000, 2990),
  (1, 1205000, 1210000, 3060),
  (1, 1210000, 1215000, 3130),
  (1, 1215000, 1220000, 3200),
  (1, 1220000, 1225000, 3270),
  (1, 1225000, 1230000, 3340),
  (1, 1230000, 1235000, 3410),
  (1, 1235000, 1240000, 3480),
  (1, 1240000, 1245000, 3550),
  (1, 1245000, 1250000, 3620),
  (1, 1250000, 1255000, 3700),
  (1, 1255000, 1260000, 3810),
  (1, 1260000, 1265000, 3910),
  (1, 1265000, 1270000, 4010),
  (1, 1270000, 1275000, 4120),
  (1, 1275000, 1280000, 4220),
  (1, 1280000, 1285000, 4320),
  (1, 1285000, 1290000, 4430),
  (1, 1290000, 1295000, 4530),
  (1, 1295000, 1300000, 4630),
  (1, 1300000, 1500000, 4740),
  (1, 1500000, 1510000, 8760),
  (1, 1510000, 1520000, 9120),
  (1, 1520000, 1530000, 9330),
  (1, 1530000, 1540000, 9540),
  (1, 1540000, 1550000, 9740),
  (1, 1550000, 1560000, 9950),
  (1, 1560000, 1570000, 10160),
  (1, 1570000, 1580000, 10360),
  (1, 1580000, 1590000, 10570),
  (1, 1590000, 1600000, 10780),
  (1, 1600000, 1610000, 10980),
  (1, 1610000, 1620000, 11190),
  (1, 1620000, 1630000, 11400),
  (1, 1630000, 1640000, 11600),
  (1, 1640000, 1650000, 11810),
  (1, 1650000, 1660000, 12020),
  (1, 1660000, 1670000, 12220),
  (1, 1670000, 1680000, 12430),
  (1, 1680000, 1690000, 12640),
  (1, 1690000, 1700000, 12840),
  (1, 1700000, 1710000, 13050),
  (1, 1710000, 1720000, 13260),
  (1, 1720000, 1730000, 13460),
  (1, 1730000, 1740000, 13670),
  (1, 1740000, 1750000, 13880),
  (1, 1750000, 1760000, 14080),
  (1, 1760000, 1770000, 14290),
  (1, 1770000, 1780000, 14500),
  (1, 1780000, 1790000, 14700),
  (1, 1790000, 1800000, 14910),
  (1, 1800000, 1810000, 15110),
  (1, 1810000, 1820000, 15320),
  (1, 1820000, 1830000, 15530),
  (1, 1830000, 1840000, 15730),
  (1, 1840000, 1850000, 15940),
  (1, 1850000, 1860000, 16150),
  (1, 1860000, 1870000, 16350),
  (1, 1870000, 1880000, 16560),
  (1, 1880000, 1890000, 16770),
  (1, 1890000, 1900000, 16970),
  (1, 1900000, 2000000, 17180),
  (1, 2000000, 3000000, 19200),
  (1, 3000000, 4000000, 73060),
  (1, 4000000, 5000000, 195960),
  (1, 5000000, 6000000, 332660),
  (1, 6000000, 7000000, 505900),
  (1, 7000000, 8000000, 732700),
  (1, 8000000, 9000000, 959500),
  (1, 9000000, 10000000, 1186500),
  
  -- 10,000,000원 기준 (중요!)
  (1, 10000000, 10020000, 1507400),
  (1, 10020000, 10040000, 1510440),
  (1, 10040000, 10060000, 1514980),
  (1, 10060000, 10080000, 1519510),
  (1, 10080000, 10100000, 1524050),
  (1, 10100000, 10120000, 1528580),
  (1, 10120000, 10140000, 1533120),
  (1, 10140000, 10160000, 1537660),
  (1, 10160000, 10180000, 1542190),
  (1, 10180000, 10200000, 1546730),
  (1, 10200000, 14000000, 1551260),
  
  -- 14,000,000 ~ 28,000,000원
  (1, 14000000, 28000000, 2904600),
  
  -- 28,000,000 ~ 30,000,000원
  (1, 28000000, 30000000, 8005200),
  
  -- 30,000,000 ~ 45,000,000원
  (1, 30000000, 45000000, 8789200),
  
  -- 45,000,000 ~ 87,000,000원
  (1, 45000000, 87000000, 14789200),
  
  -- 87,000,000원 초과
  (1, 87000000, NULL, 32429200);

-- 부양가족 2인
INSERT INTO income_tax_brackets_2026 (dependent_count, income_from, income_to, tax_amount) VALUES
  (2, 0, 1500000, 0),
  (2, 1500000, 1510000, 4420),
  (2, 1510000, 1520000, 4620),
  (2, 1520000, 1530000, 4830),
  (2, 1530000, 1540000, 5040),
  (2, 1540000, 1550000, 5240),
  (2, 1550000, 1560000, 5450),
  (2, 1560000, 1570000, 5660),
  (2, 1570000, 1580000, 5860),
  (2, 1580000, 1590000, 6070),
  (2, 1590000, 1600000, 6280),
  (2, 1600000, 2000000, 6480),
  (2, 2000000, 3000000, 14540),
  (2, 3000000, 4000000, 55560),
  (2, 4000000, 5000000, 167950),
  (2, 5000000, 6000000, 306710),
  (2, 6000000, 7000000, 466060),
  (2, 7000000, 8000000, 684290),
  (2, 8000000, 9000000, 909890),
  (2, 9000000, 10000000, 1135710),
  (2, 10000000, 14000000, 1431570),
  (2, 14000000, 28000000, 2828670),
  (2, 28000000, 30000000, 7929270),
  (2, 30000000, 45000000, 8713270),
  (2, 45000000, 87000000, 14713270),
  (2, 87000000, NULL, 32353270);

-- 부양가족 3인
INSERT INTO income_tax_brackets_2026 (dependent_count, income_from, income_to, tax_amount) VALUES
  (3, 0, 2800000, 0),
  (3, 2800000, 3000000, 24850),
  (3, 3000000, 4000000, 31450),
  (3, 4000000, 5000000, 109590),
  (3, 5000000, 6000000, 237850),
  (3, 6000000, 7000000, 395720),
  (3, 7000000, 8000000, 599590),
  (3, 8000000, 9000000, 810790),
  (3, 9000000, 10000000, 1024090),
  (3, 10000000, 14000000, 1200840),
  (3, 14000000, 28000000, 2598840),
  (3, 28000000, 30000000, 7699440),
  (3, 30000000, 45000000, 8483440),
  (3, 45000000, 87000000, 14483440),
  (3, 87000000, NULL, 32123440);

-- 확인
SELECT 
  '간이세액표 업데이트 완료' AS 상태,
  COUNT(*) AS 총_행수,
  COUNT(DISTINCT dependent_count) AS 부양가족_구간수
FROM income_tax_brackets_2026;

-- 테스트: 과세소득 10,033,883원, 부양가족 1인
-- 예상: 약 1,507,400원 (10,000,000원 기준값)
SELECT 
  '부양가족 1인, 과세소득 10,033,883원' AS 테스트,
  calculate_income_tax_2026(10033883, 1) AS 소득세,
  ROUND(calculate_income_tax_2026(10033883, 1) * 0.1) AS 지방소득세,
  calculate_income_tax_2026(10033883, 1) + ROUND(calculate_income_tax_2026(10033883, 1) * 0.1) AS 총_세금;

-- 테스트: 과세소득 10,000,000원, 부양가족 1인
SELECT 
  '부양가족 1인, 과세소득 10,000,000원' AS 테스트,
  calculate_income_tax_2026(10000000, 1) AS 소득세,
  ROUND(calculate_income_tax_2026(10000000, 1) * 0.1) AS 지방소득세;

-- 간이세액표 확인 (부양가족 1인, 9,000,000 ~ 11,000,000 구간)
SELECT 
  ROUND(income_from / 1000000.0, 1) || '~' || 
  COALESCE(ROUND(income_to / 1000000.0, 1)::TEXT, '∞') || '백만원' AS 구간,
  FORMAT('%,d원', tax_amount::INTEGER) AS 세액
FROM income_tax_brackets_2026
WHERE dependent_count = 1
  AND income_from >= 9000000
  AND income_from <= 11000000
ORDER BY income_from;
