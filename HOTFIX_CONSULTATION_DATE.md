# ğŸ”§ ìƒë‹´ì¼ì§€ ë‚ ì§œ ì œì•½ì¡°ê±´ í•«í”½ìŠ¤ (í•œêµ­ì‹œê°„ ê¸°ì¤€)

## ğŸ“‹ ë¬¸ì œ ìƒí™©
- **ì—ëŸ¬**: `consultations_consult_date_check` ì œì•½ì¡°ê±´ ìœ„ë°˜
- **ì›ì¸**: ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ `consult_date <= now()` ì œì•½ìœ¼ë¡œ ë¯¸ë˜ ë‚ ì§œ ì…ë ¥ ë¶ˆê°€
- **ì‹œê°„ëŒ€ ë¬¸ì œ**: UTCì™€ í•œêµ­ì‹œê°„(KST) í˜¼ì¬ë¡œ ì¸í•œ ë‚ ì§œ ì²˜ë¦¬ ë¶ˆì¼ì¹˜
- **ë°œìƒ í™˜ê²½**: Vercel ë°°í¬ í™˜ê²½

## ğŸ› ï¸ í•´ê²° ë°©ë²•

### 1. í•œêµ­ì‹œê°„(KST) ê¸°ì¤€ í†µì¼
- **ìƒˆë¡œìš´ ìœ í‹¸ë¦¬í‹°**: `app/lib/date-utils.ts` ìƒì„±
- **ëª¨ë“  ë‚ ì§œ ì²˜ë¦¬**: í•œêµ­ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ í†µì¼
- **ì‹œê°„ëŒ€ ìƒìˆ˜**: `Asia/Seoul` ì‚¬ìš©

### 2. ë°ì´í„°ë² ì´ìŠ¤ ì œì•½ì¡°ê±´ ìˆ˜ì • (ê¸´ê¸‰ ìˆ˜ì •)
```sql
-- ê¸°ì¡´ ì œì•½ì¡°ê±´ ì œê±°
ALTER TABLE consultations DROP CONSTRAINT IF EXISTS consultations_consult_date_check;

-- ìƒˆë¡œìš´ ì œì•½ì¡°ê±´ ì¶”ê°€ (2ë…„ ë²”ìœ„ë¡œ í™•ì¥)
ALTER TABLE consultations ADD CONSTRAINT consultations_consult_date_check 
  CHECK (
    consult_date >= '1900-01-01'::timestamp with time zone AND 
    consult_date <= (NOW() + INTERVAL '2 years')
  );
```

**âš¡ ê¸´ê¸‰ ìˆ˜ì •ì‚¬í•­**: 
- ë‚ ì§œ ë²”ìœ„ë¥¼ í˜„ì¬+2ë…„ìœ¼ë¡œ í™•ì¥í•˜ì—¬ í…ŒìŠ¤íŠ¸ ë° ë¯¸ë˜ ë‚ ì§œ ì…ë ¥ í—ˆìš©
- í•œêµ­ì‹œê°„ ê¸°ì¤€ ëŒ€ì‹  UTC ê¸°ì¤€ìœ¼ë¡œ ë‹¨ìˆœí™”í•˜ì—¬ í˜¸í™˜ì„± í–¥ìƒ

### 3. ë°±ì—”ë“œ ë‚ ì§œ ê²€ì¦ ê°•í™” (í•œêµ­ì‹œê°„ ê¸°ì¤€)
- **API ë¼ìš°íŠ¸**: `app/api/consultation-v2/route.ts`
- **ë¼ì´ë¸ŒëŸ¬ë¦¬**: `app/lib/supabase-consultation.ts`
- **ìƒˆ ìœ í‹¸ë¦¬í‹°**: `validateKoreaDateRange()`, `toKoreaISOString()` ì‚¬ìš©
- **ê²€ì¦ ë²”ìœ„**: 1900ë…„ ì´í›„ ~ í˜„ì¬+2ë…„ ì´ë‚´ (ê¸´ê¸‰ í™•ì¥)

### 4. í”„ë¡ íŠ¸ì—”ë“œ í•œêµ­ì‹œê°„ ì²˜ë¦¬
- **ìƒˆ ìƒë‹´ì¼ì§€**: í•œêµ­ì‹œê°„ ê¸°ì¤€ ì´ˆê¸°ê°’ ë° min/max ì„¤ì •
- **í¸ì§‘ ëª¨ë‹¬**: í•œêµ­ì‹œê°„ ê¸°ì¤€ ë‚ ì§œ ë³€í™˜ ë° í‘œì‹œ
- **ë‚ ì§œ í‘œì‹œ**: `formatKoreaDateTime()` í•¨ìˆ˜ë¡œ í†µì¼

## ğŸ“ ìˆ˜ì •ëœ íŒŒì¼ë“¤

### ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤
- `database/consultation_schema_fix.sql` (í•œêµ­ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ìˆ˜ì •)
- `database/emergency_constraint_fix.sql` (ê¸´ê¸‰ ì œì•½ì¡°ê±´ ìˆ˜ì •)

### ğŸ”§ ë°±ì—”ë“œ
- `app/lib/date-utils.ts` (ìƒˆë¡œ ìƒì„± - í•œêµ­ì‹œê°„ ìœ í‹¸ë¦¬í‹°)
- `app/api/consultation-v2/route.ts` (í•œêµ­ì‹œê°„ ê²€ì¦ ì ìš©)
- `app/lib/supabase-consultation.ts` (í•œêµ­ì‹œê°„ ë³€í™˜ ì ìš©)

### ğŸ¨ í”„ë¡ íŠ¸ì—”ë“œ
- `app/consultation/page.tsx` (í•œêµ­ì‹œê°„ ê¸°ì¤€ ë‚ ì§œ ì²˜ë¦¬)

## ğŸš€ ë°°í¬ ìˆœì„œ

### 1. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì—…ë°ì´íŠ¸
```bash
# Supabase SQL Editorì—ì„œ ì‹¤í–‰
-- database/consultation_schema_fix.sql ë‚´ìš© ì‹¤í–‰
```

### 2. ì½”ë“œ ë°°í¬
- GitHubì— í‘¸ì‹œí•˜ë©´ ìë™ ë°°í¬ë¨
- Vercel í™˜ê²½ì—ì„œ ìƒˆë¡œìš´ ë‚ ì§œ ê²€ì¦ ë¡œì§ ì ìš©

### 3. í…ŒìŠ¤íŠ¸
- ë¯¸ë˜ ë‚ ì§œ ì…ë ¥ í…ŒìŠ¤íŠ¸ (1ë…„ ì´ë‚´)
- ê³¼ê±° ë‚ ì§œ ì…ë ¥ í…ŒìŠ¤íŠ¸ (1900ë…„ ì´í›„)
- ë²”ìœ„ ì´ˆê³¼ ë‚ ì§œ ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸

## âœ… ê²€ì¦ í¬ì¸íŠ¸

1. **ì •ìƒ ì¼€ì´ìŠ¤ (í•œêµ­ì‹œê°„ ê¸°ì¤€)**
   - í˜„ì¬ í•œêµ­ì‹œê°„ ë‚ ì§œ ì…ë ¥ âœ…
   - ê³¼ê±° ë‚ ì§œ ì…ë ¥ (1900ë…„ ì´í›„) âœ…
   - ë¯¸ë˜ ë‚ ì§œ ì…ë ¥ (í˜„ì¬+2ë…„ ì´ë‚´) âœ…
   - ì‹œê°„ëŒ€ ìë™ ë³€í™˜ í™•ì¸ âœ…

2. **ì—ëŸ¬ ì¼€ì´ìŠ¤**
   - 1900ë…„ ì´ì „ ë‚ ì§œ ì…ë ¥ âŒ
   - í˜„ì¬+2ë…„ ì´ˆê³¼ ë‚ ì§œ ì…ë ¥ âŒ
   - ì˜ëª»ëœ ë‚ ì§œ í˜•ì‹ âŒ

## ğŸ“ ë¬¸ì˜
- ë¬¸ì œ ë°œìƒ ì‹œ ë¡œê·¸ í™•ì¸: `/api/health` ì—”ë“œí¬ì¸íŠ¸
- ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ ì½˜ì†” í™•ì¸
- ì„œë²„ ë¡œê·¸ì—ì„œ ìƒì„¸ ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸

---

**ì ìš© ì™„ë£Œ ë‚ ì§œ**: 2024-12-19  
**í•«í”½ìŠ¤ ë²„ì „**: v1.1.0 (í•œêµ­ì‹œê°„ ê¸°ì¤€ í†µì¼)

## ğŸŒ í•œêµ­ì‹œê°„(KST) ì²˜ë¦¬ íŠ¹ì§•

- **ì¼ê´€ëœ ì‹œê°„ëŒ€**: ëª¨ë“  ë‚ ì§œ ì²˜ë¦¬ê°€ `Asia/Seoul` ê¸°ì¤€
- **ìë™ ë³€í™˜**: ì‚¬ìš©ì ì…ë ¥ì´ ìë™ìœ¼ë¡œ í•œêµ­ì‹œê°„ìœ¼ë¡œ ë³€í™˜
- **í‘œì‹œ í†µì¼**: ëª¨ë“  ë‚ ì§œ í‘œì‹œê°€ í•œêµ­ì‹œê°„ ê¸°ì¤€
- **ê²€ì¦ ì •í™•ì„±**: í•œêµ­ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œ ë²”ìœ„ ê²€ì¦ 