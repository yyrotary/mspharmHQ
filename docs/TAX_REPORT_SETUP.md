# ðŸš€ ì„¸ë¬´ì‚¬ ë³´ê³  ê¸°ëŠ¥ ì„¤ì • ê°€ì´ë“œ

## ðŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] 1. ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ìƒì„±
- [ ] 2. í™˜ê²½ë³€ìˆ˜ ì„¤ì •
- [ ] 3. ì„¸ë¬´ì‚¬ ì´ë©”ì¼ ë“±ë¡
- [ ] 4. í…ŒìŠ¤íŠ¸

---

## Step 1: ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ìƒì„±

### Supabase SQL Editorì—ì„œ ì‹¤í–‰

1. Supabase Dashboard â†’ SQL Editor
2. "New Query" í´ë¦­
3. ì•„ëž˜ SQL ë³µì‚¬ & ì‹¤í–‰:

```sql
-- ===================================
-- ê¸‰ì—¬ ì‹œìŠ¤í…œ ì„¤ì • í…Œì´ë¸” ìƒì„±
-- ===================================

-- payroll_settings í…Œì´ë¸” ìƒì„±
CREATE TABLE IF NOT EXISTS payroll_settings (
  id INTEGER PRIMARY KEY DEFAULT 1,
  accountant_email VARCHAR(255),
  company_name VARCHAR(255),
  company_registration_number VARCHAR(50),
  created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT single_settings_row CHECK (id = 1)
);

-- ì´ˆê¸° ë ˆì½”ë“œ ì‚½ìž…
INSERT INTO payroll_settings (id) 
VALUES (1) 
ON CONFLICT (id) DO NOTHING;

-- RLS ë¹„í™œì„±í™”
ALTER TABLE payroll_settings DISABLE ROW LEVEL SECURITY;

-- í…Œì´ë¸” ì„¤ëª…
COMMENT ON TABLE payroll_settings IS 'ê¸‰ì—¬ ì‹œìŠ¤í…œ ì„¤ì • (ì„¸ë¬´ì‚¬ ì´ë©”ì¼ ë“±)';

-- í™•ì¸
SELECT 'payroll_settings í…Œì´ë¸”ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤' AS message;
SELECT * FROM payroll_settings;
```

4. "Run" í´ë¦­
5. ê²°ê³¼ í™•ì¸: âœ… "payroll_settings í…Œì´ë¸”ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤"

---

## Step 2: í™˜ê²½ë³€ìˆ˜ ì„¤ì •

### A. Resend ê°€ìž… ë° API Key ë°œê¸‰ (ë¬´ë£Œ)

1. **Resend ê°€ìž…**
   - ë°©ë¬¸: https://resend.com
   - "Start Building for Free" í´ë¦­
   - ì´ë©”ì¼ë¡œ ê°€ìž… (ë¬´ë£Œ)

2. **API Key ìƒì„±**
   - Dashboard â†’ "API Keys" ë©”ë‰´
   - "Create API Key" í´ë¦­
   - ì´ë¦„: "mspharmHQ"
   - Permission: "Full access"
   - ìƒì„± â†’ **API Key ë³µì‚¬** (re_xxxxx...)

3. **ë°œì‹ ìž ì´ë©”ì¼ ì„¤ì •**
   - ì˜µì…˜ 1 (í…ŒìŠ¤íŠ¸): `onboarding@resend.dev` ì‚¬ìš©
   - ì˜µì…˜ 2 (ê¶Œìž¥): ìžì²´ ë„ë©”ì¸ ì¸ì¦
     - Dashboard â†’ "Domains"
     - ë„ë©”ì¸ ì¶”ê°€ â†’ DNS ë ˆì½”ë“œ ì„¤ì •

### B. ë¡œì»¬ í™˜ê²½ë³€ìˆ˜ ì„¤ì • (.env.local)

í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ `.env.local` íŒŒì¼ì— ì¶”ê°€:

```bash
# ì´ë©”ì¼ ì „ì†¡ ì„¤ì • (Resend)
RESEND_API_KEY=re_xxxxxxxxxxxxxxxxxxxxxxxxxx
EMAIL_FROM=onboarding@resend.dev
```

**âš ï¸ ì£¼ì˜**: `.env.local`ì€ Gitì— ì»¤ë°‹í•˜ì§€ ë§ˆì„¸ìš”!

### C. Vercel ë°°í¬ í™˜ê²½ë³€ìˆ˜

1. Vercel Dashboard â†’ í”„ë¡œì íŠ¸ ì„ íƒ
2. "Settings" â†’ "Environment Variables"
3. ì¶”ê°€:
   ```
   Key: RESEND_API_KEY
   Value: re_xxxxxxxxxxxxxxxxxxxxxxxxxx
   
   Key: EMAIL_FROM
   Value: noreply@yourdomain.com
   ```
4. "Save"
5. ìž¬ë°°í¬ (Deployments â†’ "Redeploy")

---

## Step 3: ì„¸ë¬´ì‚¬ ì´ë©”ì¼ ë“±ë¡

1. **ê´€ë¦¬ìž ë¡œê·¸ì¸**
   - `/employee-purchase/login`
   - Owner ë˜ëŠ” Manager ê³„ì •

2. **ì„¸ë¬´ì‚¬ ë³´ê³  ë©”ë‰´**
   - ì¢Œì¸¡ ë©”ë‰´ â†’ "ì„¸ë¬´ì‚¬ ë³´ê³ "

3. **ì´ë©”ì¼ ì„¤ì •**
   - "ðŸ“§ ì„¸ë¬´ì‚¬ ì´ë©”ì¼ ì„¤ì •" ì„¹ì…˜
   - [âœŽ ìˆ˜ì •] í´ë¦­
   - ì´ë©”ì¼ ìž…ë ¥: `accountant@example.com`
   - [âœ“ ì €ìž¥] í´ë¦­
   - âœ… "ì„¸ë¬´ì‚¬ ì´ë©”ì¼ì´ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤"

---

## Step 4: í…ŒìŠ¤íŠ¸

### 4-1. ê¸‰ì—¬ í™•ì •

1. **ê¸‰ì—¬ ì •ì‚°**
   - "ì›” ê¸‰ì—¬ ì •ì‚° ë° í™•ì •" ë©”ë‰´
   - ì§ì› ì„ íƒ
   - Step 1~4 ì§„í–‰
   - **[ê¸‰ì—¬ í™•ì •]** í´ë¦­
   - âœ… status='approved' ìƒíƒœë¡œ ì €ìž¥

### 4-2. ê¸‰ì—¬ëŒ€ìž¥ ìƒì„±

1. **ì„¸ë¬´ì‚¬ ë³´ê³  ë©”ë‰´**
   - "ì„¸ë¬´ì‚¬ ë³´ê³ " í´ë¦­

2. **ëŒ€ìž¥ ìƒì„±**
   - ì›” ì„ íƒ: 2026-01
   - [ðŸ“Š ê¸‰ì—¬ëŒ€ìž¥ ìƒì„±] í´ë¦­
   - âœ… í™•ì •ëœ ê¸‰ì—¬ ëª©ë¡ í‘œì‹œ

3. **ê²°ê³¼ í™•ì¸**
   - "í™•ì •ëœ ê¸‰ì—¬: Nëª…" í‘œì‹œ
   - í…Œì´ë¸”ì— ê¸‰ì—¬ ë°ì´í„° í‘œì‹œ

### 4-3. ì´ë©”ì¼ ì „ì†¡ í…ŒìŠ¤íŠ¸

1. **Excel ë‹¤ìš´ë¡œë“œ**
   - [ðŸ“¥ Excel ë‹¤ìš´ë¡œë“œ] í´ë¦­
   - CSV íŒŒì¼ ë‹¤ìš´ë¡œë“œ í™•ì¸
   - Excelì—ì„œ ì—´ì–´ë³´ê¸°

2. **ì´ë©”ì¼ ì „ì†¡**
   - [ðŸ“§ ì„¸ë¬´ì‚¬ ì „ì†¡] í´ë¦­
   - í™•ì¸ íŒì—…: "í™•ì¸"
   - ê²°ê³¼ í™•ì¸:
     - âœ… **ì„±ê³µ**: "ì„¸ë¬´ì‚¬ì—ê²Œ ì´ë©”ì¼ì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤"
     - âš ï¸ **ê°œë°œ ëª¨ë“œ**: "ì´ë©”ì¼ ì „ì†¡ì´ ì‹œë®¬ë ˆì´ì…˜ë˜ì—ˆìŠµë‹ˆë‹¤"
     - âŒ **ì‹¤íŒ¨**: ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸

### 4-4. ì´ë©”ì¼ í™•ì¸

1. **ì„¸ë¬´ì‚¬ ì´ë©”ì¼ í™•ì¸**
   - ë°›ì€íŽ¸ì§€í•¨ í™•ì¸
   - ì œëª©: `[ê¸‰ì—¬ëŒ€ìž¥] 2026ë…„ 1ì›” ê¸‰ì—¬ëŒ€ìž¥`
   - ì²¨ë¶€íŒŒì¼: `ê¸‰ì—¬ëŒ€ìž¥_2026-01.csv`

2. **CSV íŒŒì¼ í™•ì¸**
   - Excelì—ì„œ ì—´ê¸°
   - í•œê¸€ ì •ìƒ í‘œì‹œ í™•ì¸
   - ë°ì´í„° ì •í™•ì„± í™•ì¸

---

## ðŸ” íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### âŒ "relation 'public.payroll_settings' does not exist"

**ì›ì¸**: ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ë¯¸ìƒì„±

**í•´ê²°**:
```bash
# Supabase SQL Editorì—ì„œ ì‹¤í–‰
database/create_payroll_settings.sql
```

### âŒ "ì„¸ë¬´ì‚¬ ì´ë©”ì¼ì´ ì €ìž¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤"

**ì›ì¸**: 
1. í…Œì´ë¸” ë¯¸ìƒì„±
2. RLS(Row Level Security) í™œì„±í™”

**í•´ê²°**:
```sql
-- RLS ë¹„í™œì„±í™”
ALTER TABLE payroll_settings DISABLE ROW LEVEL SECURITY;

-- í™•ì¸
SELECT * FROM payroll_settings;
```

### âš ï¸ "ê°œë°œ ëª¨ë“œ: ì´ë©”ì¼ ì „ì†¡ì´ ì‹œë®¬ë ˆì´ì…˜ë˜ì—ˆìŠµë‹ˆë‹¤"

**ì›ì¸**: `RESEND_API_KEY` í™˜ê²½ë³€ìˆ˜ ë¯¸ì„¤ì •

**í•´ê²°**:
1. `.env.local` íŒŒì¼ì— `RESEND_API_KEY` ì¶”ê°€
2. ì„œë²„ ìž¬ì‹œìž‘: `npm run dev`

**í™•ì¸**:
```javascript
console.log('RESEND_API_KEY:', process.env.RESEND_API_KEY ? 'ì„¤ì •ë¨' : 'ë¯¸ì„¤ì •');
```

### âŒ "Invalid 'from' address"

**ì›ì¸**: 
- ë„ë©”ì¸ ë¯¸ì¸ì¦ ìƒíƒœì—ì„œ ì»¤ìŠ¤í…€ ì´ë©”ì¼ ì‚¬ìš©

**í•´ê²°**:
- í…ŒìŠ¤íŠ¸ìš©: `EMAIL_FROM=onboarding@resend.dev`
- ìš´ì˜ìš©: Resendì—ì„œ ë„ë©”ì¸ ì¸ì¦ í›„ ì‚¬ìš©

### âŒ "í™•ì •ëœ ê¸‰ì—¬ê°€ ì—†ìŠµë‹ˆë‹¤"

**ì›ì¸**: 
- ì„ íƒí•œ ì›”ì— `status='approved'` ê¸‰ì—¬ ì—†ìŒ

**í•´ê²°**:
1. "ì›” ê¸‰ì—¬ ì •ì‚° ë° í™•ì •" ë©”ë‰´
2. ê¸‰ì—¬ ì •ì‚° í›„ **[ê¸‰ì—¬ í™•ì •]** ë°˜ë“œì‹œ í´ë¦­
3. statusê°€ 'approved'ë¡œ ë³€ê²½ë˜ì—ˆëŠ”ì§€ í™•ì¸

**SQL í™•ì¸**:
```sql
SELECT 
  employee_id, 
  pay_period_start, 
  status, 
  gross_pay
FROM payroll
WHERE pay_period_start >= '2026-01-01'
  AND pay_period_start < '2026-02-01'
ORDER BY employee_id;
```

### ðŸ“§ ì´ë©”ì¼ì´ ë„ì°©í•˜ì§€ ì•ŠìŒ

**í™•ì¸ì‚¬í•­**:
1. ìŠ¤íŒ¸í•¨ í™•ì¸
2. Resend Dashboard â†’ "Emails" â†’ ì „ì†¡ ìƒíƒœ í™•ì¸
3. ì„¸ë¬´ì‚¬ ì´ë©”ì¼ ì£¼ì†Œ ì •í™•í•œì§€ í™•ì¸

---

## ðŸ“Š ë¹„ìš©

### Resend ë¬´ë£Œ í”Œëžœ
- **ì›” 100ê°œ ì´ë©”ì¼**: ë¬´ë£Œ
- ì§ì› 10ëª… Ã— ì›” 1íšŒ = **ì—° 12ê°œ**
- **ê²°ë¡ **: ë¬´ë£Œë¡œ ì¶©ë¶„ âœ…

### Pro í”Œëžœ ($20/ì›”)
- ì›” 50,000ê°œ ì´ë©”ì¼
- ëŒ€ê·œëª¨ ì¡°ì§ìš©

---

## ðŸ” ë³´ì•ˆ

### API Key ë³´í˜¸
- âœ… `.env.local`ì— ì €ìž¥
- âœ… `.gitignore`ì— í¬í•¨
- âŒ ì†ŒìŠ¤ì½”ë“œì— ì§ì ‘ ìž…ë ¥ ê¸ˆì§€
- âŒ Gitì— ì»¤ë°‹ ê¸ˆì§€

### ì „ì†¡ ì´ë ¥
- ëª¨ë“  ì „ì†¡ ë‚´ì—­ì€ `tax_reports` í…Œì´ë¸”ì— ì €ìž¥
- ëˆ„ê°€, ì–¸ì œ, ëˆ„êµ¬ì—ê²Œ ë³´ëƒˆëŠ”ì§€ ì¶”ì  ê°€ëŠ¥

---

## ðŸ“š ê´€ë ¨ ë¬¸ì„œ

- [ì´ë©”ì¼ ì„¤ì • ìƒì„¸ ê°€ì´ë“œ](./EMAIL_SETUP_GUIDE.md)
- [ê¸‰ì—¬ ì‹œìŠ¤í…œ ê°€ì´ë“œ](./PAYROLL_2026_GUIDE.md)
- [HR ì‹œìŠ¤í…œ ë¬¸ì„œ](./HR_MANAGEMENT_SYSTEM.md)

---

## âœ… ì™„ë£Œ í™•ì¸

ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸:

1. [ ] ê¸‰ì—¬ ì •ì‚° â†’ í™•ì • (status='approved')
2. [ ] ì„¸ë¬´ì‚¬ ì´ë©”ì¼ ì €ìž¥ í™•ì¸
3. [ ] ê¸‰ì—¬ëŒ€ìž¥ ìƒì„± (í™•ì •ëœ ê¸‰ì—¬ë§Œ í‘œì‹œ)
4. [ ] Excel ë‹¤ìš´ë¡œë“œ í™•ì¸
5. [ ] ì´ë©”ì¼ ì „ì†¡ ì„±ê³µ í™•ì¸
6. [ ] ì„¸ë¬´ì‚¬ ë©”ì¼í•¨ì—ì„œ ì´ë©”ì¼ ìˆ˜ì‹  í™•ì¸

---

**ðŸŽ‰ ëª¨ë‘ ì™„ë£Œë˜ë©´ ì„¸ë¬´ì‚¬ ë³´ê³  ì‹œìŠ¤í…œì´ ì •ìƒ ìž‘ë™í•©ë‹ˆë‹¤!**
