# MSPharmHQ GUI 현재 상태 문서

## GUI 개요
MSPharmHQ는 Next.js 기반의 웹 애플리케이션으로, 모바일과 데스크톱 모두에서 사용 가능한 반응형 디자인을 채택하고 있습니다.

## 디자인 시스템
- **색상 스킴**: 
  - 주 색상: 청색 계열 (#2563eb, #1e40af)
  - 각 기능별 구분 색상:
    - 고객 상담: 청색 (#2563eb)
    - 상담 내역: 청록색 (#0891b2)
    - 고객 목록: 분홍색 (#ec4899)
    - 고객 인식: 녹색 (#10b981)
    - 수입/지출: 보라색 (#8b5cf6)
    - 월별 통계: 주황색 (#f59e0b)
- **스타일링**: Tailwind CSS를 활용한 유틸리티 기반 스타일링
- **레이아웃**: 카드 기반 UI, 그림자 효과로 깊이감 표현

## 주요 화면 구성

### 1. 메인 홈페이지 (`/`)
- **헤더**: 명성약국 로고와 브랜드
- **메인 섹션**: 
  - 약국 소개 카드: 로고 이미지, 슬로건, 소개 문구
  - 서비스 메뉴: 6개의 주요 기능 카드
    - 각 카드는 아이콘, 제목, 설명으로 구성
    - 왼쪽 테두리 색상으로 기능 구분
    - 호버 효과 없음 (모바일 최적화)
- **푸터**: 저작권 정보

### 2. 고객 상담 (`/consultation`)
- **네비게이션**: 홈으로, 고객 목록 링크
- **제목**: 고객 상담
- **고객 검색 섹션**:
  - 검색 입력창
  - 검색 버튼
  - 신규 고객 등록 버튼 (우측 상단)
- **검색 결과**: 고객 목록 표시
- **상담 내용 입력**: 
  - 선택된 고객 정보 표시
  - 호소증상 입력
  - 처방약 입력
  - 결과 입력
  - 이미지 업로드
  - 저장/취소 버튼
- **고객 정보 섹션**:
  - 고객 기본 정보 표시
  - "정보 수정" 버튼
  - "📷 이미지 모아보기" 버튼
- **상담 내역 목록**:
  - 각 상담 카드에 고유 ID 할당
  - 이미지 모아보기에서 "상담 상세 보기" 클릭 시 해당 상담으로 스크롤
  - 3초간 녹색 하이라이트 효과

### 3. 상담 내역 (`/consultation-history`)
- **기간 선택**: 날짜 범위 선택기
- **검색 필터**: 
  - 고객명 검색
  - 호소증상 검색
- **결과 표시**: 
  - 테이블 형식
  - 날짜, 고객명, 호소증상, 처방약, 결과
  - 페이지네이션
- **상담 내역 카드**:
  - 각 상담 카드에 고객별 "📷 이미지 모아보기" 버튼 추가
  - 상담 내역에서 직접 해당 고객의 이미지 갤러리 접근 가능

### 4. 고객 목록 (`/customer-list`)
- **검색 바**: 고객 이름/전화번호 검색
- **고객 테이블**:
  - 이름
  - 전화번호
  - 생년월일
  - 등록일
  - 마지막 방문일
  - 액션 버튼 (수정/삭제/📷 이미지 모아보기)
- **신규 고객 등록 버튼**

### 4-1. 고객별 이미지 모아보기 (`/consultation-history/image-gallery`)
- **접근 방법**: 
  - 고객 목록에서 📷 버튼 클릭
  - 상담 페이지 고객 정보 섹션에서 "📷 이미지 모아보기" 버튼 클릭
  - 상담 내역 카드에서 고객별 이미지 모아보기 버튼 클릭
- **페이지 구성**:
  - 제목: "{고객명} 이미지 모아보기"
  - 고객 정보 표시 (이름, 총 이미지 수)
  - 반응형 그리드 레이아웃 (250px 최소 크기)
- **이미지 카드 구성**:
  - 3:4 비율 이미지 썸네일
  - 하단 오버레이: 고객명, 상담 날짜
  - 상담 내용 미리보기
  - 호버 효과: 1.02배 확대
- **이미지 확대 모달**:
  - 최대 85vw × 70vh 크기
  - 고객명, 상담 날짜, 상담 내용 표시
  - "상담 상세 보기" 버튼 → 해당 상담으로 스크롤 이동
  - 배경 클릭 또는 × 버튼으로 닫기
- **목적**: 특정 고객의 증상 호전도 추적 및 비교 분석

### 5. 고객 인식 (`/customer-recognition`)
- **카메라 뷰**: 실시간 카메라 스트림
- **얼굴 인식 오버레이**: 감지된 얼굴 표시
- **인식 결과**: 
  - 고객 정보 표시
  - 신뢰도 점수
  - 상담하기 버튼
- **수동 검색**: 인식 실패 시 수동 검색 옵션

### 6. 수입/지출 관리 (`/daily-income`)
- **날짜 선택**: 캘린더 위젯
- **입력 폼**:
  - 구분 (수입/지출) 선택
  - 금액 입력
  - 내용 입력
  - 카테고리 선택
- **일일 요약**: 
  - 총 수입
  - 총 지출
  - 순이익
- **거래 내역 리스트**

### 7. 월별 통계 (`/daily-income/monthly`)
- **월 선택**: 월 선택기
- **통계 카드**:
  - 월 총 수입
  - 월 총 지출
  - 월 순이익
  - 전월 대비 증감
- **차트**:
  - 일별 추이 그래프
  - 카테고리별 원형 차트
- **상세 내역 테이블**

## UI/UX 특징
1. **반응형 디자인**: 모바일 우선 설계
2. **직관적 네비게이션**: 명확한 메뉴 구조
3. **일관된 디자인 언어**: 카드 기반 레이아웃
4. **접근성**: 명확한 레이블과 대비
5. **성능 최적화**: Next.js의 이미지 최적화 활용

## 기술적 구현
- **프레임워크**: Next.js 15 (App Router)
- **스타일링**: Tailwind CSS 3.x
- **상태 관리**: React Hooks
- **날짜 처리**: date-fns, react-datepicker
- **아이콘**: 이모지 기반 (별도 아이콘 라이브러리 미사용)



### 8. 마스터 로그인 (`/master-login`)
- **접근 방법**: 메인 페이지 상단의 🔐 마스터 로그인 버튼
- **인증 방식**: 
  - 이름 입력 (약국장 성명)
  - 4자리 비밀번호 (숫자만)
  - Supabase owner 권한 검증
- **디자인**:
  - 그라데이션 배경 (blue-600 → purple-600)
  - 비밀번호 입력 시 마스킹 처리
  - 에러 메시지 표시
- **보안**: owner 권한이 없는 사용자는 접근 불가

### 9. 마스터 대시보드 (`/master-dashboard`)
- **접근 권한**: owner 권한 필수
- **주요 기능**:
  - 수입/지출 관리: 일일 수입과 지출 기록
  - 월별 통계: 월간 수입/지출 통계 및 분석
  - MSP Family 구매 관리: 직원 구매 승인 및 관리
- **빠른 액세스 메뉴**:
  - 각 기능별 카드로 구성
  - 아이콘과 설명 포함
  - 색상 코딩으로 기능 구분
- **보안**: 페이지 접근 시 owner 권한 재확인

## 메인 GUI 구조 변경사항 (2025-05-28)

### 비공개 기능 처리
- **수입/지출 관리**: 메인 페이지에서 제거, 마스터 전용으로 이동
- **월별 통계**: 메인 페이지에서 제거, 마스터 전용으로 이동
- **보안 강화**: 일반 사용자는 재무 관련 기능 접근 불가

### 새로운 접근 흐름
1. 일반 사용자: 고객 관리, 상담, 직원 구매 기능만 사용
2. 마스터 사용자: 상단 마스터 로그인 통해 재무 관리 기능 접근

## 직원 구매 장부 시스템 사용자 인터페이스

### 페이지 구조

#### 1. 로그인 페이지 (`/employee-purchase/login`)
- 직원 이름과 비밀번호 입력
- 테스트 계정 정보 표시
- 로그인 성공 시 대시보드로 이동

#### 2. 대시보드 (`/employee-purchase`)
- 사용자 정보 표시 (이름, 권한)
- 기능별 메뉴 카드:
  - 새 구매 신청
  - 내 구매 내역
  - 승인 관리 (manager, owner만)
  - 통계 및 리포트 (owner만)

#### 3. 새 구매 신청 (`/employee-purchase/new`)
- 물품명, 금액, 설명 입력
- 이미지 파일 업로드 (최대 5개)
- 신청 완료 후 대시보드로 이동

#### 4. 구매 내역 (`/employee-purchase/requests`)
- 본인의 구매 요청 목록 표시
- 상태별 필터링 (전체, 대기, 승인, 거부)
- 이미지 미리보기 및 확대 보기

#### 5. 승인 관리 (`/employee-purchase/admin`) - 새로 추가됨
**접근 권한**: manager, owner

**기능**:
- 대기 중인 구매 요청 목록 표시
- 각 요청에 대한 승인/거부 버튼
- 처리된 요청 내역 표시
- 이미지 미리보기 및 확대 보기

**UI 구성**:
- 상단: 페이지 제목, 대시보드 링크
- 사용자 정보: 이름, 권한, 대기 중인 요청 수
- 승인 대기 섹션: 노란색 배경의 카드 형태
- 처리된 요청 섹션: 회색 배경의 카드 형태

**승인 대기 카드 구성**:
- 물품명 (제목)
- 신청자 이름
- 신청일
- 금액 (우측 상단)
- 상태 배지
- 설명 (있는 경우)
- 첨부 이미지 (있는 경우)
- 승인/거부 버튼

**처리된 요청 카드 구성**:
- 물품명 (제목)
- 신청자 이름
- 신청일, 처리일
- 금액 (우측 상단)
- 상태 배지 (승인됨/거부됨)
- 설명 (있는 경우)
- 첨부 이미지 (있는 경우)

#### 6. 통계 및 리포트 (`/employee-purchase/admin/statistics`)
**접근 권한**: owner만
- 전체 구매 현황 통계
- 월별/직원별 분석

### 권한별 접근 제한

#### Staff (직원)
- 로그인, 대시보드
- 새 구매 신청
- 내 구매 내역

#### Manager (관리자)
- Staff 권한 + 승인 관리

#### Owner (약국장)
- Manager 권한 + 통계 및 리포트

### 상태 표시

#### 구매 요청 상태
- **승인 대기**: 노란색 배지 (bg-yellow-100 text-yellow-800)
- **승인됨**: 초록색 배지 (bg-green-100 text-green-800)
- **거부됨**: 빨간색 배지 (bg-red-100 text-red-800)

### 사용자 경험 개선사항

#### 이미지 처리
- 썸네일 미리보기 (20x20px)
- 클릭 시 새 창에서 원본 이미지 보기
- 최대 5개 이미지 업로드 지원

#### 반응형 디자인
- 모바일, 태블릿, 데스크톱 지원
- Grid 레이아웃 (1열 → 2열 → 3열)

#### 로딩 상태
- 스피너 애니메이션
- 버튼 비활성화 및 "처리 중..." 텍스트

#### 알림 시스템
- 성공/오류 토스트 메시지
- 사용자 친화적인 한국어 메시지
